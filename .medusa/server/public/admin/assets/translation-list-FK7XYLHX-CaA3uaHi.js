import{I as $}from"./chunk-KIIT4BNH-BpOahSTL.js";import{T as C}from"./chunk-GIZFNLKK-DddN8j21.js";import{r as x,b as w,v as F,gt as R,gu as A,j as e,ah as B,C as v,H as S,a4 as o,L as D,B as W,u as q,a0 as U,P as V,al as P,a5 as G,I as J}from"./index-t_36LRbD.js";import"./Trans-BxMkbcZj.js";var K=Object.defineProperty,b=Object.getOwnPropertySymbols,z=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,E=(t,s,a)=>s in t?K(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,Q=(t,s)=>{for(var a in s||(s={}))z.call(s,a)&&E(t,a,s[a]);if(b)for(var a of b(s))O.call(s,a)&&E(t,a,s[a]);return t},X=(t,s)=>{var a={};for(var n in t)z.call(t,n)&&s.indexOf(n)<0&&(a[n]=t[n]);if(t!=null&&b)for(var n of b(t))s.indexOf(n)<0&&O.call(t,n)&&(a[n]=t[n]);return a};const I=x.forwardRef((t,s)=>{var a=t,{color:n="currentColor"}=a,m=X(a,["color"]);return x.createElement("svg",Q({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:s},m),x.createElement("path",{stroke:n,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M1.5 3.278h7.111M5.056 1.5v1.778M3.278 3.278a5.43 5.43 0 0 0 3.577 4.919"}),x.createElement("path",{stroke:n,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6.833 3.278C6.478 8.278 1.5 8.61 1.5 8.61M7.722 13.5l2.667-7.111h.444l2.667 7.11M8.556 11.278h4.111"}))});I.displayName="Language";var Y=({locales:t})=>{const{t:s}=w(),a=q(),[n,m]=x.useState(!1),d=x.useCallback(()=>{a("/settings/translations/add-locales")},[a]),h=x.useCallback(()=>t.length<=2?t.map(r=>r.name).join(", "):`${t.slice(0,2).map(r=>r.name).join(", ")} + ${t.length-2}`,[t]),p=t.length>0;return e.jsxs(v,{className:"flex flex-col p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(S,{level:"h2",children:s("translations.activeLocales.heading")}),e.jsx(U,{variant:"transparent",onClick:d,children:e.jsx(V,{})})]}),e.jsx("div",{className:"px-1 pb-1",children:p?e.jsx(P,{open:n,content:e.jsx("div",{className:"flex flex-col gap-y-1 p-1",children:t.map(g=>e.jsx(o,{size:"small",weight:"plus",children:g.name},g.code))}),children:e.jsxs(v,{className:"bg-ui-bg-component border-r-1 flex items-center gap-x-4 px-[19px] py-2",onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),children:[e.jsx($,{className:"border-ui-border-base border",children:e.jsx(I,{})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(o,{size:"small",weight:"plus",children:s("translations.activeLocales.subtitle")}),e.jsx(o,{className:"text-ui-fg-subtle",size:"small",children:h()})]})]})}):e.jsx(G,{label:"Tip",children:s("translations.activeLocales.noLocalesTip")})})]})},Z=({entities:t,hasLocales:s=!1})=>{const{t:a}=w();return e.jsx(v,{className:"divide-y p-0",children:t.map(n=>e.jsxs("div",{className:"grid grid-cols-[250px_1fr_auto] items-center gap-x-4 px-6 py-4",children:[e.jsx(o,{size:"small",weight:"plus",children:n.label}),e.jsx(o,{size:"small",className:"text-ui-fg-subtle",children:a("translations.list.metrics",{translated:(n.translatedCount??0).toLocaleString(),total:(n.totalCount??0).toLocaleString()})}),e.jsx(D,{to:`/settings/translations/edit?reference=${n.reference}`,children:e.jsx(W,{variant:"secondary",size:"small",disabled:!s||!n.totalCount,children:"Edit"})})]},n.reference))})},ee=({statistics:t,locales:s})=>{const{t:a}=w(),[n,m]=x.useState(null),{translatedCount:d,totalCount:h}=Object.values(t).reduce((l,i)=>({translatedCount:l.translatedCount+i.translated,totalCount:l.totalCount+i.expected}),{totalCount:0,translatedCount:0}),p=h>0?d/h*100:0,g=Math.max(0,h-d),r=x.useMemo(()=>{const l=new Map;return s.forEach(i=>{l.set(i.code,{translated:0,expected:0})}),Object.values(t).forEach(i=>{i.by_locale&&Object.entries(i.by_locale).forEach(([c,y])=>{const f=l.get(c);f&&(f.translated+=y.translated,f.expected+=y.expected)})}),s.map(i=>{const c=l.get(i.code)||{translated:0,expected:0};return{code:i.code,name:i.name,translated:c.translated,toTranslate:Math.max(0,c.expected-c.translated),total:c.expected}})},[t,s]),N=x.useMemo(()=>Math.max(...r.map(l=>l.total),1),[r]),j=x.useMemo(()=>r.length,[r]);return e.jsxs(v,{className:"p-0",children:[e.jsxs("div",{className:"flex flex-col gap-y-4 px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(S,{level:"h2",children:a("translations.completion.heading")}),e.jsxs(o,{size:"small",weight:"plus",className:"text-ui-fg-subtle",children:[d.toLocaleString()," ",a("general.of")," ",h.toLocaleString()]})]}),e.jsx("div",{className:"flex h-3 w-full overflow-hidden",children:p>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-0.5 h-full rounded-sm transition-all",style:{width:`${p}%`,backgroundColor:"var(--tag-blue-icon)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}}),e.jsx("div",{className:"h-full flex-1 rounded-sm",style:{backgroundColor:"var(--tag-blue-border)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}})]}):e.jsx("div",{className:"h-full w-full rounded-sm",style:{backgroundColor:"var(--tag-blue-border)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(o,{size:"small",weight:"plus",className:"text-ui-fg-subtle",children:[p.toFixed(1),"%"]}),e.jsxs(o,{size:"small",weight:"plus",className:"text-ui-fg-subtle",children:[g.toLocaleString()," ",a("general.remaining").toLowerCase()]})]})]}),r.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(J,{variant:"dashed"}),e.jsxs("div",{className:"flex flex-col gap-y-3 px-6 pb-6 pt-4",children:[e.jsx("div",{className:"flex h-32 w-full items-end gap-1",children:r.map(l=>{const i=l.total/N*100,c=l.total>0?l.translated/l.total*100:0;return e.jsx(P,{open:n===l.code,content:e.jsxs("div",{className:"flex min-w-[150px] flex-col gap-y-1 p-1",children:[e.jsx(o,{size:"small",weight:"plus",children:l.name}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full",style:{backgroundColor:"var(--tag-blue-icon)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}}),e.jsx(o,{size:"small",weight:"plus",className:"text-ui-fg-base",children:a("translations.completion.translated")})]}),e.jsx(o,{size:"small",weight:"plus",className:"text-ui-fg-base",children:l.translated})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full",style:{backgroundColor:"var(--tag-blue-border)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}}),e.jsx(o,{size:"small",weight:"plus",className:"text-ui-fg-base",children:a("translations.completion.toTranslate")})]}),e.jsx(o,{size:"small",weight:"plus",className:"text-ui-fg-base",children:l.toTranslate})]})]}),children:e.jsx("div",{className:"flex h-full flex-1 items-end justify-center",children:e.jsx("div",{className:"flex w-full min-w-2 max-w-[96px] flex-col justify-end overflow-hidden rounded-t-sm transition-opacity",style:{height:`${i}%`},onMouseEnter:()=>m(l.code),onMouseLeave:()=>m(null),children:c===0?e.jsx("div",{className:"w-full rounded-sm",style:{height:"100%",backgroundColor:"var(--tag-neutral-bg)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full rounded-sm",style:{height:`${100-c}%`,backgroundColor:"var(--tag-blue-border)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)",minHeight:l.toTranslate>0?"2px":"0"}}),c>0&&e.jsx("div",{className:"mt-0.5 w-full rounded-sm",style:{height:`${c}%`,backgroundColor:"var(--tag-blue-icon)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)",minHeight:l.translated>0?"2px":"0"}})]})})})},l.code)})}),j<9&&e.jsx("div",{className:"flex w-full gap-1",children:r.map(l=>e.jsx("div",{className:"flex flex-1 items-center justify-center",children:e.jsx(o,{size:"xsmall",weight:"plus",className:"text-ui-fg-subtle min-w-2 whitespace-normal break-words text-center leading-tight",children:j<6?l.name:l.code})},l.code))}),j>9&&e.jsx(o,{weight:"plus",size:"xsmall",className:"text-ui-fg-subtle text-center",children:a("translations.completion.footer")})]})]})]})},ne=()=>{var f,L,_,T;const{t}=w(),{store:s,isPending:a,isError:n,error:m}=F(),{translatable_fields:d,isPending:h,isError:p,error:g}=R(),{statistics:r,isPending:N,isError:j,error:l}=A({locales:((f=s==null?void 0:s.supported_locales)==null?void 0:f.map(u=>u.locale_code))??[],entity_types:Object.keys(d??{})},{enabled:!!d&&!!s&&((L=s.supported_locales)==null?void 0:L.length)>0});if(n||p||j)throw m||g||l;const i=((s==null?void 0:s.supported_locales)??[]).length>0,c=x.useMemo(()=>d?Object.entries(d).filter(([u])=>!["product_option","product_option_value"].includes(u)).map(([u,H])=>{const M=(r==null?void 0:r[u])??{translated:0,expected:0};return{label:u.split("_").map(k=>k.charAt(0).toUpperCase()+k.slice(1)).join(" "),reference:u,translatableFields:H,translatedCount:M.translated,totalCount:M.expected}}):[],[d,r]);return!!s&&!a&&!h&&!!d&&(!!r&&!N||!i)?e.jsxs(C,{widgets:{before:[],after:[],sideBefore:[],sideAfter:[]},children:[e.jsxs(C.Main,{children:[e.jsxs(v,{className:"flex flex-col px-6 py-4",children:[e.jsxs(S,{children:["Manage ",t("translations.domain")]}),e.jsx(o,{className:"text-ui-fg-subtle",size:"small",children:t("translations.subtitle")})]}),e.jsx(Z,{entities:c,hasLocales:i})]}),e.jsxs(C.Sidebar,{children:[e.jsx(Y,{locales:((_=s==null?void 0:s.supported_locales)==null?void 0:_.map(u=>u.locale))??[]}),e.jsx(ee,{statistics:r??{},locales:((T=s==null?void 0:s.supported_locales)==null?void 0:T.map(u=>u.locale))??[]})]})]}):e.jsx(B,{sidebarSections:2})};export{ne as Component};
