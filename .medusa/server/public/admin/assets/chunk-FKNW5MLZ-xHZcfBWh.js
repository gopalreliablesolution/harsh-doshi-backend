import{c as Jt}from"./chunk-DK4WIVY6-CYCbBMOO.js";import{r as c,cK as qt,cL as Ee,bm as en,j as u,ba as it,g as tn,Z as U,$ as me,al as Le,ao as nn,F as sn,c8 as xt,bB as rn,bE as ln,bH as wt,cM as on,cN as an,aM as cn,aN as un,bK as dn,aP as fn,a3 as hn,b as we,cO as J,z as mn,by as ye,cP as pn,B as je,cQ as gn,cR as bn,cS as vn,cT as xn,cU as wn,cV as Cn,cW as yn,H as jn,cX as kn,bS as at,cY as En,a0 as Sn,a7 as Mn,K as _n,a4 as Dn}from"./index-t_36LRbD.js";import{T as In}from"./textarea-Nkhb9pGS.js";var On=Object.defineProperty,Se=Object.getOwnPropertySymbols,Ct=Object.prototype.hasOwnProperty,yt=Object.prototype.propertyIsEnumerable,ct=(e,n,t)=>n in e?On(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,An=(e,n)=>{for(var t in n||(n={}))Ct.call(n,t)&&ct(e,t,n[t]);if(Se)for(var t of Se(n))yt.call(n,t)&&ct(e,t,n[t]);return e},Nn=(e,n)=>{var t={};for(var s in e)Ct.call(e,s)&&n.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&Se)for(var s of Se(e))n.indexOf(s)<0&&yt.call(e,s)&&(t[s]=e[s]);return t};const jt=c.forwardRef((e,n)=>{var t=e,{color:s="currentColor"}=t,r=Nn(t,["color"]);return c.createElement("svg",An({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:n},r),c.createElement("g",{clipPath:"url(#a)"},c.createElement("path",{fill:s,d:"M8.5 2.528h-.778a.75.75 0 1 0 0 1.5h1.08a4 4 0 0 1-.302-1.5M10.695 6.07a4 4 0 0 1-1.21-.94.75.75 0 0 0-.29.592V6.75H1.5a.75.75 0 0 0 0 1.5h7.694v1.028a.75.75 0 0 0 1.5 0zM5.806 1.5a.75.75 0 1 0-1.5 0v1.028H1.5a.75.75 0 0 0 0 1.5h2.806v1.028a.75.75 0 0 0 1.5 0V1.5M12.611 6.75a.75.75 0 0 0 0 1.5h.889a.75.75 0 0 0 0-1.5zM6.972 11.722a.75.75 0 0 1 .75-.75H13.5a.75.75 0 1 1 0 1.5H7.722a.75.75 0 0 1-.75-.75M1.5 10.972a.75.75 0 0 0 0 1.5h2.806V13.5a.75.75 0 0 0 1.5 0V9.944a.75.75 0 1 0-1.5 0v1.028z"}),c.createElement("circle",{cx:12.5,cy:2.5,r:2.5,fill:"#2563EB"}),c.createElement("circle",{cx:12.5,cy:2.5,r:2.25,stroke:s,strokeOpacity:.24,strokeWidth:.5})),c.createElement("defs",null,c.createElement("clipPath",{id:"a"},c.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});jt.displayName="AdjustmentsDone";var zn=Object.defineProperty,Me=Object.getOwnPropertySymbols,kt=Object.prototype.hasOwnProperty,Et=Object.prototype.propertyIsEnumerable,ut=(e,n,t)=>n in e?zn(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Rn=(e,n)=>{for(var t in n||(n={}))kt.call(n,t)&&ut(e,t,n[t]);if(Me)for(var t of Me(n))Et.call(n,t)&&ut(e,t,n[t]);return e},Pn=(e,n)=>{var t={};for(var s in e)kt.call(e,s)&&n.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&Me)for(var s of Me(e))n.indexOf(s)<0&&Et.call(e,s)&&(t[s]=e[s]);return t};const St=c.forwardRef((e,n)=>{var t=e,{color:s="currentColor"}=t,r=Pn(t,["color"]);return c.createElement("svg",Rn({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:n},r),c.createElement("path",{fill:s,fillRule:"evenodd",d:"M6.713.838a1.61 1.61 0 0 1 1.574 0l4.521 2.531h.001c.507.286.823.823.823 1.407v.356c0 .89-.722 1.611-1.611 1.611l-9.042.001c-.89 0-1.611-.722-1.611-1.611v-.357c0-.582.314-1.12.823-1.406zm.842 1.309a.11.11 0 0 0-.108 0L2.924 4.678a.11.11 0 0 0-.056.097v.357c0 .061.05.111.111.111h9.042c.06 0 .11-.05.11-.112v-.356a.11.11 0 0 0-.056-.098zM2.979 7.396a.75.75 0 0 1 .75.75v3.986h1.514V8.146a.75.75 0 0 1 1.5 0v3.986h.41c.414 0 .78.344.78.759 0 .414-.366.741-.78.741H2.117a.75.75 0 0 1 0-1.5h.111V8.146a.75.75 0 0 1 .75-.75M9.338 8.72a.75.75 0 0 1 1.06 0l1.623 1.622 1.622-1.622a.75.75 0 1 1 1.06 1.06l-1.621 1.623 1.622 1.622a.75.75 0 0 1-1.06 1.061l-1.623-1.623-1.623 1.623a.75.75 0 0 1-1.06-1.06l1.622-1.623L9.338 9.78a.75.75 0 0 1 0-1.06",clipRule:"evenodd"}),c.createElement("path",{fill:s,d:"M7.5 4.701a.861.861 0 1 0 0-1.722.861.861 0 0 0 0 1.722"}))});St.displayName="TaxExclusive";var Fn=Object.defineProperty,_e=Object.getOwnPropertySymbols,Mt=Object.prototype.hasOwnProperty,_t=Object.prototype.propertyIsEnumerable,dt=(e,n,t)=>n in e?Fn(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Tn=(e,n)=>{for(var t in n||(n={}))Mt.call(n,t)&&dt(e,t,n[t]);if(_e)for(var t of _e(n))_t.call(n,t)&&dt(e,t,n[t]);return e},Gn=(e,n)=>{var t={};for(var s in e)Mt.call(e,s)&&n.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&_e)for(var s of _e(e))n.indexOf(s)<0&&_t.call(e,s)&&(t[s]=e[s]);return t};const Dt=c.forwardRef((e,n)=>{var t=e,{color:s="currentColor"}=t,r=Gn(t,["color"]);return c.createElement("svg",Tn({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:n},r),c.createElement("path",{fill:s,fillRule:"evenodd",d:"M6.713.838a1.61 1.61 0 0 1 1.574 0l4.521 2.531h.001c.507.286.823.823.823 1.407v.356c0 .89-.722 1.611-1.611 1.611l-9.042.001c-.89 0-1.611-.722-1.611-1.611v-.357c0-.582.314-1.12.824-1.406zm.842 1.309a.11.11 0 0 0-.108 0L2.925 4.678a.11.11 0 0 0-.057.097v.357c0 .061.05.111.111.111h9.042c.06 0 .11-.05.11-.112v-.356a.11.11 0 0 0-.056-.098zM2.979 7.396a.75.75 0 0 1 .75.75v3.986h1.514V8.146a.75.75 0 0 1 1.5 0v3.986h.346c.414 0 .812.337.812.75 0 .415-.398.75-.812.75H2.118a.75.75 0 0 1 0-1.5h.111V8.146a.75.75 0 0 1 .75-.75m6.028 0a.75.75 0 0 1 .75.75v1.292a.75.75 0 0 1-1.5 0V8.146a.75.75 0 0 1 .75-.75m5.588.733a.75.75 0 0 1 .2 1.042l-3.215 4.736a.75.75 0 0 1-1.16.1l-1.522-1.579a.75.75 0 0 1 1.08-1.041l.88.913 2.695-3.971a.75.75 0 0 1 1.042-.2",clipRule:"evenodd"}),c.createElement("path",{fill:s,d:"M7.5 4.701a.861.861 0 1 0 0-1.722.861.861 0 0 0 0 1.722"}))});Dt.displayName="TaxInclusive";var Vn=function(e){var n=e.as,t=e.errors,s=e.name,r=e.message,l=e.render,i=function(h,x){if(h==null)return{};var g,p,v={},j=Object.keys(h);for(p=0;p<j.length;p++)x.indexOf(g=j[p])>=0||(v[g]=h[g]);return v}(e,["as","errors","name","message","render"]),o=qt(),a=Ee(t||o.formState.errors,s);if(!a)return null;var f=a.message,d=a.types,m=Object.assign({},i,{children:f||r});return c.isValidElement(n)?c.cloneElement(n,m):l?l({message:f||r,messages:d}):c.createElement(n||c.Fragment,m)};function fe(e,n,t){let s=t.initialDeps??[],r,l=!0;function i(){var o,a,f;let d;t.key&&((o=t.debug)!=null&&o.call(t))&&(d=Date.now());const m=e();if(!(m.length!==s.length||m.some((g,p)=>s[p]!==g)))return r;s=m;let x;if(t.key&&((a=t.debug)!=null&&a.call(t))&&(x=Date.now()),r=n(...m),t.key&&((f=t.debug)!=null&&f.call(t))){const g=Math.round((Date.now()-d)*100)/100,p=Math.round((Date.now()-x)*100)/100,v=p/16,j=(y,C)=>{for(y=String(y);y.length<C;)y=" "+y;return y};console.info(`%c⏱ ${j(p,5)} /${j(g,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*v,120))}deg 100% 31%);`,t==null?void 0:t.key)}return t!=null&&t.onChange&&!(l&&t.skipInitialOnChange)&&t.onChange(r),l=!1,r}return i.updateDeps=o=>{s=o},i}function ft(e,n){if(e===void 0)throw new Error("Unexpected undefined");return e}const Kn=(e,n)=>Math.abs(e-n)<1.01,$n=(e,n,t)=>{let s;return function(...r){e.clearTimeout(s),s=e.setTimeout(()=>n.apply(this,r),t)}},ht=e=>{const{offsetWidth:n,offsetHeight:t}=e;return{width:n,height:t}},Ln=e=>e,Bn=e=>{const n=Math.max(e.startIndex-e.overscan,0),t=Math.min(e.endIndex+e.overscan,e.count-1),s=[];for(let r=n;r<=t;r++)s.push(r);return s},Wn=(e,n)=>{const t=e.scrollElement;if(!t)return;const s=e.targetWindow;if(!s)return;const r=i=>{const{width:o,height:a}=i;n({width:Math.round(o),height:Math.round(a)})};if(r(ht(t)),!s.ResizeObserver)return()=>{};const l=new s.ResizeObserver(i=>{const o=()=>{const a=i[0];if(a!=null&&a.borderBoxSize){const f=a.borderBoxSize[0];if(f){r({width:f.inlineSize,height:f.blockSize});return}}r(ht(t))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()});return l.observe(t,{box:"border-box"}),()=>{l.unobserve(t)}},mt={passive:!0},pt=typeof window>"u"?!0:"onscrollend"in window,Hn=(e,n)=>{const t=e.scrollElement;if(!t)return;const s=e.targetWindow;if(!s)return;let r=0;const l=e.options.useScrollendEvent&&pt?()=>{}:$n(s,()=>{n(r,!1)},e.options.isScrollingResetDelay),i=d=>()=>{const{horizontal:m,isRtl:h}=e.options;r=m?t.scrollLeft*(h&&-1||1):t.scrollTop,l(),n(r,d)},o=i(!0),a=i(!1);a(),t.addEventListener("scroll",o,mt);const f=e.options.useScrollendEvent&&pt;return f&&t.addEventListener("scrollend",a,mt),()=>{t.removeEventListener("scroll",o),f&&t.removeEventListener("scrollend",a)}},Un=(e,n,t)=>{if(n!=null&&n.borderBoxSize){const s=n.borderBoxSize[0];if(s)return Math.round(s[t.options.horizontal?"inlineSize":"blockSize"])}return e[t.options.horizontal?"offsetWidth":"offsetHeight"]},Yn=(e,{adjustments:n=0,behavior:t},s)=>{var r,l;const i=e+n;(l=(r=s.scrollElement)==null?void 0:r.scrollTo)==null||l.call(r,{[s.options.horizontal?"left":"top"]:i,behavior:t})};class Zn{constructor(n){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let t=null;const s=()=>t||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:t=new this.targetWindow.ResizeObserver(r=>{r.forEach(l=>{const i=()=>{this._measureElement(l.target,l)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(i):i()})}));return{disconnect:()=>{var r;(r=s())==null||r.disconnect(),t=null},observe:r=>{var l;return(l=s())==null?void 0:l.observe(r,{box:"border-box"})},unobserve:r=>{var l;return(l=s())==null?void 0:l.unobserve(r)}}})(),this.range=null,this.setOptions=t=>{Object.entries(t).forEach(([s,r])=>{typeof r>"u"&&delete t[s]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Ln,rangeExtractor:Bn,onChange:()=>{},measureElement:Un,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...t}},this.notify=t=>{var s,r;(r=(s=this.options).onChange)==null||r.call(s,this,t)},this.maybeNotify=fe(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),t=>{this.notify(t)},{key:"maybeNotify",debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(t=>t()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var t;const s=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==s){if(this.cleanup(),!s){this.maybeNotify();return}this.scrollElement=s,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((t=this.scrollElement)==null?void 0:t.window)??null,this.elementsCache.forEach(r=>{this.observer.observe(r)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,r=>{this.scrollRect=r,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(r,l)=>{this.scrollAdjustments=0,this.scrollDirection=l?this.getScrollOffset()<r?"forward":"backward":null,this.scrollOffset=r,this.isScrolling=l,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(t,s)=>{const r=new Map,l=new Map;for(let i=s-1;i>=0;i--){const o=t[i];if(r.has(o.lane))continue;const a=l.get(o.lane);if(a==null||o.end>a.end?l.set(o.lane,o):o.end<a.end&&r.set(o.lane,!0),r.size===this.options.lanes)break}return l.size===this.options.lanes?Array.from(l.values()).sort((i,o)=>i.end===o.end?i.index-o.index:i.end-o.end)[0]:void 0},this.getMeasurementOptions=fe(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(t,s,r,l,i,o)=>(this.prevLanes!==void 0&&this.prevLanes!==o&&(this.lanesChangedFlag=!0),this.prevLanes=o,this.pendingMeasuredCacheIndexes=[],{count:t,paddingStart:s,scrollMargin:r,getItemKey:l,enabled:i,lanes:o}),{key:!1,skipInitialOnChange:!0,onChange:()=>{this.notify(this.isScrolling)}}),this.getMeasurements=fe(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:t,paddingStart:s,scrollMargin:r,getItemKey:l,enabled:i,lanes:o},a)=>{if(!i)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>t)for(const h of this.laneAssignments.keys())h>=t&&this.laneAssignments.delete(h);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(h=>{this.itemSizeCache.set(h.key,h.size)}));const f=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===t&&(this.lanesSettling=!1);const d=this.measurementsCache.slice(0,f),m=new Array(o).fill(void 0);for(let h=0;h<f;h++){const x=d[h];x&&(m[x.lane]=h)}for(let h=f;h<t;h++){const x=l(h),g=this.laneAssignments.get(h);let p,v;if(g!==void 0&&this.options.lanes>1){p=g;const S=m[p],k=S!==void 0?d[S]:void 0;v=k?k.end+this.options.gap:s+r}else{const S=this.options.lanes===1?d[h-1]:this.getFurthestMeasurement(d,h);v=S?S.end+this.options.gap:s+r,p=S?S.lane:h%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(h,p)}const j=a.get(x),y=typeof j=="number"?j:this.options.estimateSize(h),C=v+y;d[h]={index:h,start:v,size:y,end:C,key:x,lane:p},m[p]=h}return this.measurementsCache=d,d},{key:"getMeasurements",debug:()=>this.options.debug}),this.calculateRange=fe(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(t,s,r,l)=>this.range=t.length>0&&s>0?Qn({measurements:t,outerSize:s,scrollOffset:r,lanes:l}):null,{key:"calculateRange",debug:()=>this.options.debug}),this.getVirtualIndexes=fe(()=>{let t=null,s=null;const r=this.calculateRange();return r&&(t=r.startIndex,s=r.endIndex),this.maybeNotify.updateDeps([this.isScrolling,t,s]),[this.options.rangeExtractor,this.options.overscan,this.options.count,t,s]},(t,s,r,l,i)=>l===null||i===null?[]:t({startIndex:l,endIndex:i,overscan:s,count:r}),{key:"getVirtualIndexes",debug:()=>this.options.debug}),this.indexFromElement=t=>{const s=this.options.indexAttribute,r=t.getAttribute(s);return r?parseInt(r,10):(console.warn(`Missing attribute name '${s}={index}' on measured element.`),-1)},this._measureElement=(t,s)=>{const r=this.indexFromElement(t),l=this.measurementsCache[r];if(!l)return;const i=l.key,o=this.elementsCache.get(i);o!==t&&(o&&this.observer.unobserve(o),this.observer.observe(t),this.elementsCache.set(i,t)),t.isConnected&&this.resizeItem(r,this.options.measureElement(t,s,this))},this.resizeItem=(t,s)=>{const r=this.measurementsCache[t];if(!r)return;const l=this.itemSizeCache.get(r.key)??r.size,i=s-l;i!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(r,i,this):r.start<this.getScrollOffset()+this.scrollAdjustments)&&(this.options.debug&&console.info("correction",i),this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=i,behavior:void 0})),this.pendingMeasuredCacheIndexes.push(r.index),this.itemSizeCache=new Map(this.itemSizeCache.set(r.key,s)),this.notify(!1))},this.measureElement=t=>{if(!t){this.elementsCache.forEach((s,r)=>{s.isConnected||(this.observer.unobserve(s),this.elementsCache.delete(r))});return}this._measureElement(t,void 0)},this.getVirtualItems=fe(()=>[this.getVirtualIndexes(),this.getMeasurements()],(t,s)=>{const r=[];for(let l=0,i=t.length;l<i;l++){const o=t[l],a=s[o];r.push(a)}return r},{key:"getVirtualItems",debug:()=>this.options.debug}),this.getVirtualItemForOffset=t=>{const s=this.getMeasurements();if(s.length!==0)return ft(s[It(0,s.length-1,r=>ft(s[r]).start,t)])},this.getOffsetForAlignment=(t,s,r=0)=>{const l=this.getSize(),i=this.getScrollOffset();s==="auto"&&(s=t>=i+l?"end":"start"),s==="center"?t+=(r-l)/2:s==="end"&&(t-=l);const o=this.getTotalSize()+this.options.scrollMargin-l;return Math.max(Math.min(o,t),0)},this.getOffsetForIndex=(t,s="auto")=>{t=Math.max(0,Math.min(t,this.options.count-1));const r=this.measurementsCache[t];if(!r)return;const l=this.getSize(),i=this.getScrollOffset();if(s==="auto")if(r.end>=i+l-this.options.scrollPaddingEnd)s="end";else if(r.start<=i+this.options.scrollPaddingStart)s="start";else return[i,s];const o=s==="end"?r.end+this.options.scrollPaddingEnd:r.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,s,r.size),s]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(t,{align:s="start",behavior:r}={})=>{r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(t,s),{adjustments:void 0,behavior:r})},this.scrollToIndex=(t,{align:s="auto",behavior:r}={})=>{r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),t=Math.max(0,Math.min(t,this.options.count-1));let l=0;const i=10,o=f=>{if(!this.targetWindow)return;const d=this.getOffsetForIndex(t,f);if(!d){console.warn("Failed to get offset for index:",t);return}const[m,h]=d;this._scrollToOffset(m,{adjustments:void 0,behavior:r}),this.targetWindow.requestAnimationFrame(()=>{const x=this.getScrollOffset(),g=this.getOffsetForIndex(t,h);if(!g){console.warn("Failed to get offset for index:",t);return}Kn(g[0],x)||a(h)})},a=f=>{this.targetWindow&&(l++,l<i?(this.options.debug&&console.info("Schedule retry",l,i),this.targetWindow.requestAnimationFrame(()=>o(f))):console.warn(`Failed to scroll to index ${t} after ${i} attempts.`))};o(s)},this.scrollBy=(t,{behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+t,{adjustments:void 0,behavior:s})},this.getTotalSize=()=>{var t;const s=this.getMeasurements();let r;if(s.length===0)r=this.options.paddingStart;else if(this.options.lanes===1)r=((t=s[s.length-1])==null?void 0:t.end)??0;else{const l=Array(this.options.lanes).fill(null);let i=s.length-1;for(;i>=0&&l.some(o=>o===null);){const o=s[i];l[o.lane]===null&&(l[o.lane]=o.end),i--}r=Math.max(...l.filter(o=>o!==null))}return Math.max(r-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(t,{adjustments:s,behavior:r})=>{this.options.scrollToFn(t,{behavior:r,adjustments:s},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(n)}}const It=(e,n,t,s)=>{for(;e<=n;){const r=(e+n)/2|0,l=t(r);if(l<s)e=r+1;else if(l>s)n=r-1;else return r}return e>0?e-1:0};function Qn({measurements:e,outerSize:n,scrollOffset:t,lanes:s}){const r=e.length-1,l=a=>e[a].start;if(e.length<=s)return{startIndex:0,endIndex:r};let i=It(0,r,l,t),o=i;if(s===1)for(;o<r&&e[o].end<t+n;)o++;else if(s>1){const a=Array(s).fill(0);for(;o<r&&a.some(d=>d<t+n);){const d=e[o];a[d.lane]=d.end,o++}const f=Array(s).fill(t+n);for(;i>=0&&f.some(d=>d>=t);){const d=e[i];f[d.lane]=d.start,i--}i=Math.max(0,i-i%s),o=Math.min(r,o+(s-1-o%s))}return{startIndex:i,endIndex:o}}const gt=typeof document<"u"?c.useLayoutEffect:c.useEffect;function Xn(e){const n=c.useReducer(()=>({}),{})[1],t={...e,onChange:(r,l)=>{var i;l?en.flushSync(n):n(),(i=e.onChange)==null||i.call(e,r,l)}},[s]=c.useState(()=>new Zn(t));return s.setOptions(t),gt(()=>s._didMount(),[]),gt(()=>s._willUpdate()),s}function bt(e){return Xn({observeElementRect:Wn,observeElementOffset:Hn,scrollToFn:Yn,...e})}var Jn=({columns:e,rows:n=10})=>{const t=Array.from({length:n},(r,l)=>l),s=e.length;return u.jsxs("div",{className:"bg-ui-bg-subtle size-full",children:[u.jsx("div",{className:"bg-ui-bg-base border-b p-4",children:u.jsx("div",{className:"bg-ui-button-neutral h-7 w-[116px] animate-pulse rounded-md"})}),u.jsxs("div",{className:"bg-ui-bg-subtle size-full overflow-auto",children:[u.jsx("div",{className:"grid",style:{gridTemplateColumns:`repeat(${s}, 1fr)`},children:e.map((r,l)=>u.jsx("div",{className:"bg-ui-bg-base flex h-10 w-[200px] items-center border-b border-r px-4 py-2.5 last:border-r-0",children:u.jsx(it,{className:"h-[14px] w-[164px]"})},l))}),u.jsx("div",{children:t.map((r,l)=>u.jsx("div",{className:"grid",style:{gridTemplateColumns:`repeat(${s}, 1fr)`},children:e.map((i,o)=>u.jsx("div",{className:"bg-ui-bg-base flex h-10 w-[200px] items-center border-b border-r px-4 py-2.5 last:border-r-0",children:u.jsx(it,{className:"h-[14px] w-[164px]"})},o))},l))})]})]})};function qn(e,n){typeof e=="function"?e(n):e&&"current"in e&&(e.current=n)}var pe=(...e)=>n=>{e.forEach(t=>qn(t,n))},Ot=c.createContext(null),De=()=>{const e=c.useContext(Ot);if(!e)throw new Error("useDataGridContext must be used within a DataGridContextProvider");return e};function At(e){return`${e.row}:${e.col}`}function Nt(e,n){return n?e.row===n.row&&e.col===n.col:!1}var es=[".",","];function zt(e){return es.includes(e.key)&&e.ctrlKey&&e.altKey}var ts=/^.$/u,ns=/^[0-9]$/u,ge=({context:e})=>{const{register:n,control:t,anchor:s,setIsEditing:r,setSingleRange:l,setIsSelecting:i,setRangeEnd:o,getWrapperFocusHandler:a,getWrapperMouseOverHandler:f,getInputChangeHandler:d,getIsCellSelected:m,getIsCellDragSelected:h,getCellMetadata:x}=De(),{rowIndex:g,columnIndex:p}=e,v=c.useMemo(()=>({row:g,col:p}),[g,p]),{id:j,field:y,type:C,innerAttributes:S,inputAttributes:k}=c.useMemo(()=>x(v),[v,x]),[N,K]=c.useState(!0),R=c.useRef(null),A=c.useRef(null),I=c.useCallback(_=>{if(_.preventDefault(),_.stopPropagation(),_.detail===2&&A.current){K(!1),A.current.focus();return}if(_.shiftKey&&v.col===(s==null?void 0:s.col)){o(v);return}R.current&&(l(v),i(!0),R.current.focus())},[v,s,o,l,i]),re=c.useCallback(_=>{var L;if(_.preventDefault(),_.stopPropagation(),_.detail===2){(L=A.current)==null||L.focus();return}if(_.shiftKey){o(v);return}R.current&&(l(v),i(!0),R.current.focus())},[i,l,o,v]),T=c.useCallback(()=>{K(!0),r(!1)},[r]),$=c.useCallback(()=>{K(!1),r(!0)},[r]),Q=c.useCallback(_=>{switch(C){case"togglable-number":case"number":return ns.test(_);case"text":case"multiline-text":return ts.test(_);default:return!1}},[C]),ee=c.useCallback(_=>{var L,le;if(!(!A.current||!Q(_.key)||!N)&&!(_.key.toLowerCase()==="z"&&(_.ctrlKey||_.metaKey))&&!(_.key.toLowerCase()==="c"&&(_.ctrlKey||_.metaKey))&&!(_.key.toLowerCase()==="v"&&(_.ctrlKey||_.metaKey))&&_.key!=="Enter"&&!zt(_.nativeEvent)){if(A.current.focus(),K(!1),A.current instanceof HTMLInputElement){A.current.value="";const W=(L=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))==null?void 0:L.set;W==null||W.call(A.current,_.key);const te=new Event("input",{bubbles:!0});A.current.dispatchEvent(te)}else if(A.current instanceof HTMLTextAreaElement){A.current.value="";const W=(le=Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype,"value"))==null?void 0:le.set;W==null||W.call(A.current,_.key);const te=new Event("input",{bubbles:!0});A.current.dispatchEvent(te)}_.stopPropagation(),_.preventDefault()}},[N,Q]),z=c.useMemo(()=>s?Nt(v,s):!1,[s,v]),V=c.useMemo(()=>C==="boolean",[C]);c.useEffect(()=>{var _,L;z&&!((_=R.current)!=null&&_.contains(document.activeElement))&&((L=R.current)==null||L.focus({preventScroll:!0}))},[z]);const Y={container:{field:y,isAnchor:z,isSelected:m(v),isDragSelected:h(v),showOverlay:V?!1:N,innerProps:{ref:R,onMouseOver:f(v),onMouseDown:C==="boolean"?re:void 0,onKeyDown:ee,onFocus:a(v),...S},overlayProps:{onMouseDown:I}},input:{ref:A,onBlur:T,onFocus:$,onChange:d(y),...k}};return{id:j,field:y,register:n,control:t,renderProps:Y}},ie=({context:e})=>{const{errors:n,getCellErrorMetadata:t,navigateToField:s}=De(),{rowIndex:r,columnIndex:l}=e,{accessor:i,field:o}=c.useMemo(()=>t({row:r,col:l}),[r,l,t]),a=i&&l===0?Ee(n,i):void 0,f=[];function d(h,x){if(h)if(ss(h)){const g=h.message,p=()=>s(x);g&&f.push({message:g,to:p})}else Object.keys(h).forEach(g=>{const p=h[g],v=`${x}.${g}`;p&&typeof p=="object"&&d(p,v)})}a&&i&&d(a,i);const m=o?Ee(n,o):void 0;return{errors:n,rowErrors:f,cellError:m}};function ss(e){return typeof e=="object"&&"message"in e&&"type"in e}var he=class{constructor({fields:e,prev:n,next:t,setter:s}){J(this,"_fields"),J(this,"_prev"),J(this,"_next"),J(this,"_setter"),this._fields=e,this._prev=n,this._next=t,this._setter=s}execute(e=!1){this._setter(this._fields,this._next,e)}undo(){this._setter(this._fields,this._prev,!0)}redo(){this.execute(!0)}},rs=class{constructor(e,n,t=!1){J(this,"multiColumnSelection"),J(this,"cells"),J(this,"rowAccessors",[]),J(this,"columnAccessors",[]),this.multiColumnSelection=t,this.cells=this._populateCells(e,n),this.rowAccessors=this._computeRowAccessors(),this.columnAccessors=this._computeColumnAccessors()}_computeRowAccessors(){return this.cells.map((e,n)=>this.getRowAccessor(n))}_computeColumnAccessors(){return this.cells.length===0?[]:this.cells[0].map((e,n)=>this.getColumnAccessor(n))}getFirstNavigableCell(){for(let e=0;e<this.cells.length;e++)for(let n=0;n<this.cells[0].length;n++)if(this.cells[e][n]!==null)return{row:e,col:n};return null}getFieldsInRow(e){const n=[];return e<0||e>=this.cells.length||this.cells[e].forEach(t=>{t!==null&&n.push(t.field)}),n}getFieldsInSelection(e,n){var o;const t=[];if(!e||!n)return t;if(!this.multiColumnSelection&&e.col!==n.col)throw new Error("Selection must be in the same column when multiColumnSelection is disabled");const s=Math.min(e.row,n.row),r=Math.max(e.row,n.row),l=this.multiColumnSelection?Math.min(e.col,n.col):e.col,i=this.multiColumnSelection?Math.max(e.col,n.col):e.col;for(let a=s;a<=r;a++)for(let f=l;f<=i;f++)this._isValidPosition(a,f)&&this.cells[a][f]!==null&&t.push((o=this.cells[a][f])==null?void 0:o.field);return t}getCellField(e){var n;return this._isValidPosition(e.row,e.col)&&((n=this.cells[e.row][e.col])==null?void 0:n.field)||null}getCellType(e){var n;return this._isValidPosition(e.row,e.col)&&((n=this.cells[e.row][e.col])==null?void 0:n.type)||null}getIsCellSelected(e,n,t){if(!e||!n||!t)return!1;if(!this.multiColumnSelection&&n.col!==t.col)throw new Error("Selection must be in the same column when multiColumnSelection is disabled");const s=Math.min(n.row,t.row),r=Math.max(n.row,t.row),l=this.multiColumnSelection?Math.min(n.col,t.col):n.col,i=this.multiColumnSelection?Math.max(n.col,t.col):n.col;return e.row>=s&&e.row<=r&&e.col>=l&&e.col<=i}toggleColumn(e,n){e<0||e>=this.cells[0].length||this.cells.forEach((t,s)=>{const r=t[e];r&&(this.cells[s][e]={...r,enabled:n})})}toggleRow(e,n){e<0||e>=this.cells.length||this.cells[e].forEach((t,s)=>{t&&(this.cells[e][s]={...t,enabled:n})})}getCoordinatesByField(e){if(this.rowAccessors.length===1){const n=this.columnAccessors.indexOf(e);return n===-1?null:{row:0,col:n}}for(let n=0;n<this.rowAccessors.length;n++){const t=this.rowAccessors[n];if(t!==null&&e.startsWith(t))for(let s=0;s<this.columnAccessors.length;s++){const r=this.columnAccessors[s];if(r===null)continue;if(`${t}.${r}`===e)return{row:n,col:s}}}return null}getRowAccessor(e){if(e<0||e>=this.cells.length)return null;const t=this.cells[e].filter(l=>l!==null).map(l=>l.field.split("."));if(t.length===0)return null;let s=t[0];for(const l of t)if(s=s.filter((i,o)=>l[o]===i),s.length===0)break;const r=s.join(".");return r||null}getColumnAccessor(e){if(e<0||e>=this.cells[0].length)return null;const n=this.cells.map((r,l)=>{const i=r[e];if(!i)return null;const o=this.getRowAccessor(l);return o&&i.field.startsWith(o+".")?i.field.slice(o.length+1):null}).filter(r=>r!==null);if(n.length===0)return null;const t=n[0];return n.every(r=>r===t)?t:null}getValidMovement(e,n,t,s=!1){var i;const[r,l]=this._getDirectionDeltas(t);if(s)return this._getLastValidCellInDirection(e,n,r,l);{let o=e+r,a=n+l;for(;this._isValidPosition(o,a);){if(this.cells[o][a]!==null&&((i=this.cells[o][a])==null?void 0:i.enabled)!==!1)return{row:o,col:a};o+=r,a+=l}return{row:e,col:n}}}_isValidPosition(e,n,t){return t||(t=this.cells),e>=0&&e<t.length&&n>=0&&n<t[0].length}_getDirectionDeltas(e){switch(e){case"ArrowUp":return[-1,0];case"ArrowDown":return[1,0];case"ArrowLeft":return[0,-1];case"ArrowRight":return[0,1];default:return[0,0]}}_getLastValidCellInDirection(e,n,t,s){let r=e,l=n,i=e,o=n;for(;this._isValidPosition(r+t,l+s);)r+=t,l+=s,this.cells[r][l]!==null&&(i=r,o=l);return{row:i,col:o}}_populateCells(e,n){const t=Array.from({length:e.length},()=>Array(n.length).fill(null));return e.forEach((s,r)=>{n.forEach((l,i)=>{if(!this._isValidPosition(r,i,t))return;const{name:o,field:a,type:f,...d}=l.meta,m={row:s,column:{...l,meta:d}},h=a?a(m):null;!h||!f||(t[r][i]={field:h,type:f,enabled:!0})})}),t}},ls=class{constructor(e){J(this,"container"),this.container=e}getInput(e){var s;const n=this._getCellId(e),t=(s=this.container)==null?void 0:s.querySelector(`[data-cell-id="${n}"]`);return t||null}getInputByField(e){var t;const n=(t=this.container)==null?void 0:t.querySelector(`[data-field="${e}"]`);return n||null}getCoordinatesByField(e){var l;const n=(l=this.container)==null?void 0:l.querySelector(`[data-field="${e}"][data-cell-id]`);if(!n)return null;const t=n.getAttribute("data-cell-id");if(!t)return null;const[s,r]=t.split(":").map(i=>parseInt(i,10));return isNaN(s)||isNaN(r)?null:{row:s,col:r}}getContainer(e){var s;const n=this._getCellId(e),t=(s=this.container)==null?void 0:s.querySelector(`[data-container-id="${n}"]`);return t||null}_getCellId(e){return At(e)}},ke=class{constructor({prev:e,next:n,setter:t}){J(this,"_prev"),J(this,"_next"),J(this,"_setter"),this._prev=e,this._next=n,this._setter=t}execute(){this._setter(this._next)}undo(){this._setter(this._prev)}redo(){this.execute()}},os=({matrix:e,anchor:n,rangeEnd:t,setRangeEnd:s,isDragging:r,setIsDragging:l,isSelecting:i,setIsSelecting:o,setSingleRange:a,dragEnd:f,setDragEnd:d,setValue:m,execute:h,multiColumnSelection:x})=>{const g=c.useCallback(k=>N=>{a(k)},[a]),p=c.useCallback(k=>N=>{if(N.stopPropagation(),N.preventDefault(),N.shiftKey){s(k);return}o(!0),a(k)},[o,s,a]),v=c.useCallback(k=>{if(!(!r&&!i))return N=>{(n==null?void 0:n.col)!==k.col&&!x||(i?s(k):d(k))}},[n==null?void 0:n.col,r,i,d,s,x]),j=c.useCallback(k=>(N,K)=>{const R=new ke({next:N,prev:K,setter:A=>{m(k,A,{shouldDirty:!0,shouldTouch:!0})}});h(R)},[m,h]),y=c.useCallback(k=>{l(!0)},[l]),C=c.useCallback(k=>!k||!n||!t?!1:e.getIsCellSelected(k,n,t),[n,t,e]),S=c.useCallback(k=>!k||!n||!f?!1:e.getIsCellSelected(k,n,f),[n,f,e]);return{getWrapperFocusHandler:g,getOverlayMouseDownHandler:p,getWrapperMouseOverHandler:v,getInputChangeHandler:j,getIsCellSelected:C,getIsCellDragSelected:S,onDragToFillStart:y}},is=({matrix:e})=>{const n=c.useCallback(s=>{const{row:r,col:l}=s,i=At(s),o=e.getCellField(s),a=e.getCellType(s);if(!o||!a)throw new Error(`'field' or 'type' is null for cell ${i}`);return{id:i,field:o,type:a,inputAttributes:{"data-row":r,"data-col":l,"data-cell-id":i,"data-field":o},innerAttributes:{"data-container-id":i}}},[e]),t=c.useCallback(s=>{const r=e.getRowAccessor(s.row),l=e.getCellField(s);return{accessor:r,field:l}},[e]);return{getCellMetadata:n,getCellErrorMetadata:t}},as=({matrix:e,form:n})=>{const[t,s]=c.useState(null),{getValues:r,setValue:l}=n,i=c.useCallback(a=>{if(!a)return null;const f=e.getCellField(a);if(!f)return null;const d=r(f);s(m=>(m==null?void 0:m.field)===f?m:{field:f,value:d})},[r,e]),o=c.useCallback(()=>{if(!t)return;const{field:a,value:f}=t;requestAnimationFrame(()=>{l(a,f)})},[l,t]);return{createSnapshot:i,restoreSnapshot:o}},cs=({matrix:e,anchor:n,rangeEnd:t,isEditing:s,getSelectionValues:r,setSelectionValues:l,execute:i})=>{const o=c.useCallback(f=>{var x;if(s||!n||!t)return;f.preventDefault();const d=e.getFieldsInSelection(n,t),h=r(d).map(g=>typeof g=="object"&&g!==null?JSON.stringify(g):`${g}`??"").join("	");(x=f.clipboardData)==null||x.setData("text/plain",h)},[s,n,t,e,r]),a=c.useCallback(f=>{var p;if(s||!n||!t)return;f.preventDefault();const d=(p=f.clipboardData)==null?void 0:p.getData("text/plain");if(!d)return;const m=d.split("	"),h=e.getFieldsInSelection(n,t),x=r(h),g=new he({fields:h,next:m,prev:x,setter:l});i(g)},[s,n,t,e,r,l,i]);return{handleCopyEvent:o,handlePasteEvent:a}};function us(e,n){const t=e.getAllLeafColumns(),s=t.map(a=>({id:a.id,name:ds(a),checked:a.getIsVisible(),disabled:!a.getCanHide()})),r=c.useCallback(a=>f=>{const d=t[a];d.getCanHide()&&(n.toggleColumn(a,f),d.toggleVisibility(f))},[t,n]),l=c.useCallback(()=>{e.setColumnVisibility({})},[e]),o=s.filter(a=>!a.disabled).length===0;return{columnOptions:s,handleToggleColumn:r,handleResetColumns:l,isDisabled:o}}function ds(e){const n=e.columnDef.id,t=e.columnDef.enableHiding,s=e==null?void 0:e.columnDef.meta;if(!n)throw new Error("Column is missing an id, which is a required field. Please provide an id for the column.");return!(s!=null&&s.name)&&t&&console.warn(`Column "${n}" does not have a name. You should add a name to the column definition. Falling back to the column id.`),(s==null?void 0:s.name)||n}var er=({duplicateOf:e})=>{const{control:n}=De();return{watchedValue:sn({control:n,name:e})}},fs=(e,n,t)=>{const[s,r]=c.useState(!1),[l,i]=c.useState(null),{flatRows:o}=n.getRowModel(),a=n.getAllFlatColumns(),f=Rt(t),d=f.length,{rowsWithErrors:m,columnsWithErrors:h}=c.useMemo(()=>{const g=new Set,p=new Set;return f.forEach(v=>{const j=e.rowAccessors.findIndex(C=>C&&(v===C||v.startsWith(`${C}.`)));j!==-1&&g.add(j);const y=e.columnAccessors.findIndex(C=>C&&(v===C||v.endsWith(`.${C}`)));y!==-1&&p.add(y)}),{rowsWithErrors:g,columnsWithErrors:p}},[f,e.rowAccessors,e.columnAccessors]),x=c.useCallback((g,p,v,j)=>{if(s)l&&(v(l.rows),j(l.columns));else{i({rows:{...g},columns:{...p}});const y=o.map((S,k)=>m.has(k)?void 0:k).filter(S=>S!==void 0),C=a.map((S,k)=>!h.has(k)&&k!==0?S.id:void 0).filter(S=>S!==void 0);v(y.reduce((S,k)=>({...S,[k]:!1}),{})),j(C.reduce((S,k)=>({...S,[k]:!1}),{}))}r(y=>!y)},[s,l,o,a,m,h]);return{errorCount:d,isHighlighted:s,toggleErrorHighlighting:x}};function Rt(e,n=[]){return typeof e!="object"||e===null?[]:"message"in e&&"type"in e?[n.join(".")]:Object.entries(e).flatMap(([t,s])=>Rt(s,[...n,t]))}var hs=({matrix:e,form:n,anchor:t})=>{const{getValues:s,reset:r}=n,l=c.useCallback(o=>{if(!o.length)return[];const a=s();return o.map(f=>f.split(".").reduce((d,m)=>d==null?void 0:d[m],a))},[s]),i=c.useCallback(async(o,a,f)=>{if(!o.length||!t)return;const d=e.getCellType(t);if(!d)return;const m=ws(a,d),h=s();o.forEach((x,g)=>{if(!x)return;const p=g%a.length,v=m[p];vs(h,x,v,d,f)}),r(h,{keepDirty:!0,keepTouched:!0,keepDefaultValues:!0})},[e,t,s,r]);return{getSelectionValues:l,setSelectionValues:i}};function ms(e){if(typeof e=="number")return e;const n=Number(e);if(isNaN(n))throw new Error(`String "${e}" cannot be converted to number.`);return n}function ps(e){if(typeof e=="boolean")return e;if(typeof e>"u"||e===null)return!1;const n=e.toLowerCase();if(n==="true"||n==="false")return n==="true";throw new Error(`String "${e}" cannot be converted to boolean.`)}function gs(e){return typeof e>"u"||e===null?"":String(e)}function bs(e){let n=e;if(typeof n=="string")try{n=JSON.parse(n)}catch{throw new Error(`String "${e}" cannot be converted to object.`)}return n}function vs(e,n,t,s,r){if(s!=="togglable-number"){n.split(".").reduce((l,i,o)=>(o===n.split(".").length-1&&(l[i]=t),l[i]??(l[i]={}),l[i]),e);return}xs(e,n,t,r)}function xs(e,n,t,s){const r=n.split(".").reduce((m,h)=>m==null?void 0:m[h],e),{disabledToggle:l}=r,i=m=>l&&m===""?0:m,o=m=>l?!0:m!==""&&m!=null,a=i(t.quantity),f=s?l?!0:t.checked:o(a),d=n.split(".");d.reduce((m,h,x)=>(x===d.length-1&&(m[h]={...e,quantity:a,checked:f}),m[h]??(m[h]={}),m[h]),e)}function ws(e,n){switch(n){case"number":return e.map(t=>t===""?t:t==null?"":ms(t));case"togglable-number":return e.map(bs);case"boolean":return e.map(ps);case"text":case"multiline-text":return e.map(gs);default:throw new Error(`Unsupported target type "${n}".`)}}var Cs=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ys=["ArrowUp","ArrowDown"],js=({containerRef:e,matrix:n,anchor:t,rangeEnd:s,isEditing:r,setTrapActive:l,scrollToCoordinates:i,setSingleRange:o,setRangeEnd:a,onEditingChangeHandler:f,getValues:d,setValue:m,execute:h,undo:x,redo:g,queryTool:p,getSelectionValues:v,setSelectionValues:j,restoreSnapshot:y,createSnapshot:C})=>{const S=c.useCallback(b=>{if(!t)return;const w=n.getCellType(t);if(r&&w!=="boolean")return;const M=ys.includes(b.key)?"vertical":"horizontal",D=M==="horizontal"?t:b.shiftKey?s:t,O=M==="horizontal"?o:b.shiftKey?a:o;if(!D)return;const{row:P,col:B}=D,q=ae=>{b.preventDefault(),b.stopPropagation(),i(ae,M),O(ae)},Ie=n.getValidMovement(P,B,b.key,b.metaKey||b.ctrlKey);q(Ie)},[r,t,s,i,o,a,n]),k=c.useCallback(b=>{if(!t)return;b.preventDefault(),b.stopPropagation();const{row:w,col:M}=t,D=b.shiftKey?"ArrowLeft":"ArrowRight",O="horizontal",P=n.getValidMovement(w,M,D,b.metaKey||b.ctrlKey);i(P,O),o(P)},[t,i,o,n]),N=c.useCallback(b=>{if(b.preventDefault(),b.shiftKey){g();return}x()},[g,x]),K=c.useCallback(b=>{const w=s??b,M=n.getFieldsInSelection(b,w),D=v(M),O=D.every(q=>q===!0),P=Array.from({length:D.length},()=>!O),B=new he({fields:M,next:P,prev:D,setter:j});h(B)},[s,n,v,j,h]),R=c.useCallback(b=>{const w=n.getCellField(b),M=p==null?void 0:p.getInput(b);!w||!M||(C(b),M.focus())},[n,p,C]),A=c.useCallback(b=>{const w=n.getCellField(b),M=p==null?void 0:p.getInput(b);if(!w||!M)return;C(b);const D=d(w),O="",P=new ke({next:O,prev:D,setter:B=>{m(w,B,{shouldDirty:!0,shouldTouch:!0})}});h(P),M.focus()},[n,p,d,h,m,C]),I=c.useCallback(b=>{const w=n.getCellField(b),M=p==null?void 0:p.getInput(b);if(!w||!M)return;C(b);const D=d(w);let O=D.checked;D.disabledToggle||(O=!1);const P={...D,quantity:"",checked:O},B=new ke({next:P,prev:D,setter:q=>{m(w,q,{shouldDirty:!0,shouldTouch:!0})}});h(B),M.focus()},[n,p,d,h,m,C]),re=c.useCallback(b=>{if(!t||r)return;b.preventDefault();const w=n.getCellType(t);if(w)switch(w){case"boolean":K(t);break;case"togglable-number":I(t);break;case"text":case"multiline-text":R(t);break;case"number":A(t);break}},[t,r,n,K,R,A,I]),T=c.useCallback((b,w)=>{const M=b.shiftKey?"ArrowUp":"ArrowDown",D=n.getValidMovement(w.row,w.col,M,!1);if(w.row!==D.row||w.col!==D.col)o(D),i(D,"vertical");else{const O=p==null?void 0:p.getContainer(w);O==null||O.focus()}f(!1)},[p,n,i,o,f]),$=c.useCallback(b=>{const w=p==null?void 0:p.getInput(b);w&&(w.focus(),f(!0))},[p,f]),Q=c.useCallback((b,w)=>{if(r){T(b,w);return}$(w)},[T,$,r]),ee=c.useCallback((b,w)=>{if(r){if(b.shiftKey)return;T(b,w);return}$(w)},[T,$,r]),z=c.useCallback((b,w)=>{const M=n.getCellField(w);if(!M)return;const D=d(M);let O;typeof D=="boolean"?O=!D:O=!0;const P=new ke({next:O,prev:D,setter:B=>{m(M,B,{shouldDirty:!0,shouldTouch:!0})}});h(P),T(b,w)},[h,d,T,n,m]),V=c.useCallback(b=>{if(!t)return;const w=n.getCellType(t);if(!(w==="multiline-text"&&r&&b.shiftKey))switch(b.preventDefault(),w){case"multiline-text":ee(b,t);break;case"togglable-number":case"text":case"number":Q(b,t);break;case"boolean":{z(b,t);break}}},[t,n,r,Q,z,ee]),Y=c.useCallback((b,w)=>{const M=n.getFieldsInSelection(b,w),D=v(M),O=D.map(B=>({...B,quantity:"",checked:B.disableToggle?B.checked:!1})),P=new he({fields:M,next:O,prev:D,setter:j});h(P)},[n,v,j,h]),_=c.useCallback((b,w)=>{const M=n.getFieldsInSelection(b,w),D=v(M),O=Array.from({length:D.length},()=>""),P=new he({fields:M,next:O,prev:D,setter:j});h(P)},[n,v,j,h]),L=c.useCallback((b,w)=>{const M=n.getFieldsInSelection(b,w),D=v(M),O=Array.from({length:D.length},()=>!1),P=new he({fields:M,next:O,prev:D,setter:j});h(P)},[h,v,n,j]),le=c.useCallback(b=>{if(!t||!s||r)return;b.preventDefault();const w=n.getCellType(t);if(w)switch(w){case"text":case"multiline-text":case"number":_(t,s);break;case"boolean":L(t,s);break;case"togglable-number":Y(t,s);break}},[t,s,r,n,_,L,Y]),W=c.useCallback(b=>{if(!t||!r)return;b.preventDefault(),b.stopPropagation(),y();const w=p==null?void 0:p.getContainer(t);w==null||w.focus()},[p,r,t,y]),te=c.useCallback(b=>{if(!e||r)return;const w=ks(e),M=D=>{D&&(l(!1),D.focus())};switch(b.key){case".":M(w.cancel);break;case",":M(w.shortcuts);break}},[r,l,e]);return{handleKeyDownEvent:c.useCallback(b=>{if(Cs.includes(b.key)){S(b);return}if(b.key==="z"&&(b.metaKey||b.ctrlKey)){N(b);return}if(b.key===" "){re(b);return}if(b.key==="Delete"||b.key==="Backspace"){le(b);return}if(b.key==="Enter"){V(b);return}if(b.key==="Escape"){W(b);return}if(b.key==="Tab"){k(b);return}},[W,S,N,re,V,le,k]),handleSpecialFocusKeys:te}};function ks(e){const n=Array.from(document.querySelectorAll("[tabindex], a, button, input, select, textarea")),t=n.indexOf(e.current),s=t>0?n[t-1]:null;let r=null;for(let l=t+1;l<n.length;l++)if(!e.current.contains(n[l])){r=n[l];break}return{shortcuts:s,cancel:r}}var Es=({matrix:e,anchor:n,dragEnd:t,setDragEnd:s,isDragging:r,setIsDragging:l,setRangeEnd:i,setIsSelecting:o,getSelectionValues:a,setSelectionValues:f,execute:d})=>{const m=c.useCallback(()=>{if(!r||!n||!t)return;const x=e.getFieldsInSelection(n,t),g=e.getCellField(n);if(!g||!x.length)return;const p=a([g]),v=x.filter(S=>S!==g),j=a(v),y=Array.from({length:j.length},()=>p[0]),C=new he({fields:v,prev:j,next:y,setter:f});d(C),l(!1),s(null),i(t)},[r,n,t,e,a,f,d,l,s,i]);return{handleMouseUpEvent:c.useCallback(()=>{m(),o(!1)},[m,o])}},Ss=({matrix:e,anchor:n,visibleColumns:t,visibleRows:s,columnVirtualizer:r,rowVirtualizer:l,setColumnVisibility:i,flatColumns:o,queryTool:a,setSingleRange:f})=>{const d=c.useCallback((h,x)=>{if(!n)return;const{row:g,col:p}=h,{row:v,col:j}=n,y=g>=v?"down":"up",C=p>=j?"right":"left";let S=y==="down"?g+1:g-1;s[S]===void 0&&(S=g);let k=C==="right"?p+1:p-1;t[k]===void 0&&(k=p);const N={align:"auto",behavior:"auto"};(x==="horizontal"||x==="both")&&r.scrollToIndex(k,N),(x==="vertical"||x==="both")&&l.scrollToIndex(S,N)},[n,r,s,l,t]),m=c.useCallback(h=>{const x=e.getCoordinatesByField(h);if(!x)return;const g=o[x.col];i(p=>({...p,[g.id]:!0})),requestAnimationFrame(()=>{d(x,"both"),f(x)}),requestAnimationFrame(()=>{const p=a==null?void 0:a.getInput(x);p&&p.focus()})},[e,o,i,d,f,a]);return{scrollToCoordinates:d,navigateToField:m}},Ms=e=>{const n=c.useRef(null);return c.useEffect(()=>{e.current&&(n.current=new ls(e.current))},[e]),n.current},Pt=({rowErrors:e})=>{const n=e?e.length:0;return!e||n<=0?null:u.jsx(Le,{content:u.jsx("ul",{className:"flex flex-col gap-y-3",children:e.map((t,s)=>u.jsx(_s,{error:t},s))}),delayDuration:0,children:u.jsx(nn,{color:"red",size:"2xsmall",className:"cursor-default",children:n})})},_s=({error:e})=>{const{t:n}=we();return u.jsxs("li",{className:"txt-compact-small flex flex-col items-start",children:[e.message,u.jsx("button",{type:"button",onClick:e.to,className:"text-ui-fg-interactive hover:text-ui-fg-interactive-hover transition-fg",children:n("dataGrid.errors.fixError")})]})},be=({isAnchor:e,isSelected:n,isDragSelected:t,field:s,showOverlay:r,placeholder:l,innerProps:i,overlayProps:o,children:a,errors:f,rowErrors:d,outerComponent:m,isMultiLine:h})=>{const g=!!Ee(f,s);return u.jsxs("div",{className:U("group/container relative h-full w-full"),children:[u.jsxs("div",{className:U("bg-ui-bg-base group/cell relative flex h-full w-full gap-x-2 px-4 py-2.5 outline-none",{"items-center":!h,"items-start":h,"bg-ui-tag-red-bg text-ui-tag-red-text":g&&!e&&!n&&!t,"ring-ui-bg-interactive ring-2 ring-inset":e,"bg-ui-bg-highlight [&:has([data-field]:focus)]:bg-ui-bg-base":n||e,"bg-ui-bg-subtle":t&&!e}),tabIndex:-1,...i,children:[u.jsx(Vn,{name:s,errors:f,render:({message:p})=>u.jsx("div",{className:"flex items-center justify-center",children:u.jsx(Le,{content:p,delayDuration:0,children:u.jsx(xt,{className:"text-ui-tag-red-icon z-[3]"})})})}),u.jsx("div",{className:U("relative z-[1] flex h-full w-full",{"items-center justify-center":!h,"items-start":h}),children:u.jsx(Ds,{isAnchor:e,placeholder:l,children:a})}),u.jsx(Pt,{rowErrors:d}),r&&u.jsx("div",{...o,"data-cell-overlay":"true",className:"absolute inset-0 z-[2]"})]}),m]})},Ds=({isAnchor:e,placeholder:n,children:t})=>!e&&n?n:t,Is=({context:e,disabled:n})=>{const{field:t,control:s,renderProps:r}=ge({context:e}),l=ie({context:e}),{container:i,input:o}=r;return u.jsx(me,{control:s,name:t,render:({field:a})=>u.jsx(be,{...i,...l,children:u.jsx(Os,{field:a,inputProps:o,disabled:n})})})},Os=({field:e,inputProps:n,disabled:t})=>{const{ref:s,value:r,onBlur:l,name:i,disabled:o}=e,{ref:a,onBlur:f,onChange:d,onFocus:m,...h}=n,x=pe(s,a);return u.jsx(hn,{disabled:t||o,name:i,checked:r,onCheckedChange:g=>d(g===!0,r),onFocus:m,onBlur:()=>{l(),f()},ref:x,tabIndex:-1,...h})},Ke=({context:e,code:n})=>{const{field:t,control:s,renderProps:r}=ge({context:e}),l=ie({context:e}),{container:i,input:o}=r,a=Jt[n.toUpperCase()];return u.jsx(me,{control:s,name:t,render:({field:f})=>u.jsx(be,{...i,...l,children:u.jsx(As,{field:f,inputProps:o,currencyInfo:a})})})},As=({field:e,inputProps:n,currencyInfo:t})=>{const{value:s,onChange:r,onBlur:l,ref:i,...o}=e,{ref:a,onBlur:f,onFocus:d,onChange:m,...h}=n,x=c.useCallback(y=>{const C=typeof y=="number"?y.toString():y||"";return on({value:C,decimalScale:t.decimal_digits,disableGroupSeparators:!0,decimalSeparator:"."})},[t]),[g,p]=c.useState(s||""),v=(y,C,S)=>{if(!y){p("");return}p(y)};c.useEffect(()=>{let y=s;isNaN(Number(s))||(y=x(y)),p(y)},[s,x]);const j=pe(a,i);return u.jsxs("div",{className:"relative flex size-full items-center",children:[u.jsx("span",{className:"txt-compact-small text-ui-fg-muted pointer-events-none absolute left-0 w-fit min-w-4","aria-hidden":!0,children:t.symbol_native}),u.jsx(an,{...o,...h,ref:j,className:"txt-compact-small w-full flex-1 cursor-default appearance-none bg-transparent pl-8 text-right outline-none",value:g||void 0,onValueChange:v,formatValueOnBlur:!0,onBlur:()=>{l(),f(),m(g,s)},onFocus:d,decimalScale:t.decimal_digits,decimalsLimit:t.decimal_digits,autoComplete:"off",tabIndex:-1})]})},Ns=({context:e})=>{const{field:n,control:t,renderProps:s}=ge({context:e}),r=ie({context:e}),{container:l,input:i}=s;return u.jsx(me,{control:t,name:n,render:({field:o})=>u.jsx(be,{...l,...r,isMultiLine:!0,children:u.jsx(zs,{field:o,inputProps:i})})})},zs=({field:e,inputProps:n})=>{const{onChange:t,onBlur:s,ref:r,value:l,...i}=e,{ref:o,onBlur:a,onChange:f,...d}=n,[m,h]=c.useState(l),x=c.useRef(null);c.useEffect(()=>{h(l)},[l]);const g=pe(o,r,x),p=c.useCallback(()=>{const v=x.current;if(v){v.style.height="0px";const j=Math.max(v.scrollHeight,24);v.style.height=`${j}px`}},[]);return c.useEffect(()=>{p()},[m,p]),c.useEffect(()=>{p();const v=setTimeout(p,50);return()=>clearTimeout(v)},[p]),u.jsx("textarea",{className:U("txt-compact-small text-ui-fg-subtle flex w-full cursor-pointer bg-transparent outline-none","focus:cursor-text","resize-none overflow-hidden py-2"),autoComplete:"off",tabIndex:-1,value:m??"",onChange:v=>{h(v.target.value),p()},ref:g,onBlur:()=>{s(),a(),f(m,l)},...d,...i})},Rs=({context:e,...n})=>{const{field:t,control:s,renderProps:r}=ge({context:e}),l=ie({context:e}),{container:i,input:o}=r;return u.jsx(me,{control:s,name:t,render:({field:a})=>u.jsx(be,{...i,...l,children:u.jsx(Ps,{field:a,inputProps:o,...n})})})},Ps=({field:e,inputProps:n,...t})=>{const{ref:s,value:r,onChange:l,onBlur:i,...o}=e,{ref:a,onChange:f,onBlur:d,onFocus:m,...h}=n,[x,g]=c.useState(r);c.useEffect(()=>{g(r)},[r]);const p=pe(a,s);return u.jsx("div",{className:"size-full",children:u.jsx("input",{ref:p,value:x,onChange:v=>g(v.target.value),onBlur:()=>{i(),d(),f(x,r)},onFocus:m,type:"number",inputMode:"decimal",className:U("txt-compact-small size-full bg-transparent outline-none","placeholder:text-ui-fg-muted"),tabIndex:-1,...t,...o,...h})})},$e=({context:e,color:n="muted",children:t,isMultiLine:s=!1})=>{const{rowErrors:r}=ie({context:e});return u.jsxs("div",{className:U("txt-compact-small text-ui-fg-subtle flex w-full cursor-not-allowed justify-between overflow-hidden px-4 py-2.5 outline-none",n==="muted"&&"bg-ui-bg-subtle",n==="normal"&&"bg-ui-bg-base","h-full items-center"),children:[u.jsx("div",{className:U("flex-1",{truncate:!s,"whitespace-pre-wrap break-words":s}),children:t}),u.jsx(Pt,{rowErrors:r})]})},Fs=(e=20)=>{const[n,t]=c.useState([]),[s,r]=c.useState([]),l=n.length>0,i=s.length>0,o=c.useCallback(()=>{if(!l)return;const d=n[n.length-1],m=n.slice(0,n.length-1);d.undo(),t(m),r([d,...s.slice(0,e-1)])},[l,s,n,e]),a=c.useCallback(()=>{if(!i)return;const d=s[0],m=s.slice(1);d.redo(),t([...n,d].slice(0,e-1)),r(m)},[i,s,n,e]),f=c.useCallback(d=>{d.execute(),t(m=>[...m,d].slice(0,e-1)),r([])},[e]);return{undo:o,redo:a,execute:f,canUndo:l,canRedo:i}},Ts=()=>{const{t:e}=we();return c.useMemo(()=>[{label:e("dataGrid.shortcuts.commands.undo"),keys:{Mac:["⌘","Z"],Windows:["Ctrl","Z"]}},{label:e("dataGrid.shortcuts.commands.redo"),keys:{Mac:["⇧","⌘","Z"],Windows:["Shift","Ctrl","Z"]}},{label:e("dataGrid.shortcuts.commands.copy"),keys:{Mac:["⌘","C"],Windows:["Ctrl","C"]}},{label:e("dataGrid.shortcuts.commands.paste"),keys:{Mac:["⌘","V"],Windows:["Ctrl","V"]}},{label:e("dataGrid.shortcuts.commands.edit"),keys:{Mac:["↵"],Windows:["Enter"]}},{label:e("dataGrid.shortcuts.commands.delete"),keys:{Mac:["⌫"],Windows:["Backspace"]}},{label:e("dataGrid.shortcuts.commands.clear"),keys:{Mac:["Space"],Windows:["Space"]}},{label:e("dataGrid.shortcuts.commands.moveUp"),keys:{Mac:["↑"],Windows:["↑"]}},{label:e("dataGrid.shortcuts.commands.moveDown"),keys:{Mac:["↓"],Windows:["↓"]}},{label:e("dataGrid.shortcuts.commands.moveLeft"),keys:{Mac:["←"],Windows:["←"]}},{label:e("dataGrid.shortcuts.commands.moveRight"),keys:{Mac:["→"],Windows:["→"]}},{label:e("dataGrid.shortcuts.commands.moveTop"),keys:{Mac:["⌘","↑"],Windows:["Ctrl","↑"]}},{label:e("dataGrid.shortcuts.commands.moveBottom"),keys:{Mac:["⌘","↓"],Windows:["Ctrl","↓"]}},{label:e("dataGrid.shortcuts.commands.selectDown"),keys:{Mac:["⇧","↓"],Windows:["Shift","↓"]}},{label:e("dataGrid.shortcuts.commands.selectUp"),keys:{Mac:["⇧","↑"],Windows:["Shift","↑"]}},{label:e("dataGrid.shortcuts.commands.selectColumnDown"),keys:{Mac:["⇧","⌘","↓"],Windows:["Shift","Ctrl","↓"]}},{label:e("dataGrid.shortcuts.commands.selectColumnUp"),keys:{Mac:["⇧","⌘","↑"],Windows:["Shift","Ctrl","↑"]}},{label:e("dataGrid.shortcuts.commands.focusToolbar"),keys:{Mac:["⌃","⌥",","],Windows:["Ctrl","Alt",","]}},{label:e("dataGrid.shortcuts.commands.focusCancel"),keys:{Mac:["⌃","⌥","."],Windows:["Ctrl","Alt","."]}}],[e])},Gs=({open:e,onOpenChange:n})=>{const{t}=we(),[s,r]=c.useState(""),l=Ts(),i=c.useMemo(()=>l.filter(o=>o.label.toLowerCase().includes(s.toLowerCase())),[s,l]);return u.jsxs(bn,{open:e,onOpenChange:n,children:[u.jsx(vn,{asChild:!0,children:u.jsx(je,{size:"small",variant:"secondary",children:t("dataGrid.shortcuts.label")})}),u.jsxs(xn,{children:[u.jsx(wn,{className:U("bg-ui-bg-overlay fixed inset-0","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0")}),u.jsxs(Cn,{className:"bg-ui-bg-subtle shadow-elevation-modal fixed left-[50%] top-[50%] flex h-full max-h-[612px] w-full max-w-[560px] translate-x-[-50%] translate-y-[-50%] flex-col divide-y overflow-hidden rounded-lg outline-none",children:[u.jsxs("div",{className:"flex flex-col gap-y-3 px-6 py-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx(yn,{asChild:!0,children:u.jsx(jn,{children:t("app.menus.user.shortcuts")})}),u.jsx(kn,{className:"sr-only"})]}),u.jsxs("div",{className:"flex items-center gap-x-2",children:[u.jsx(at,{children:"esc"}),u.jsx(En,{asChild:!0,children:u.jsx(Sn,{variant:"transparent",size:"small",children:u.jsx(Mn,{})})})]})]}),u.jsx("div",{children:u.jsx(_n,{type:"search",value:s,autoFocus:!0,onChange:o=>r(o.target.value)})})]}),u.jsx("div",{className:"flex flex-col divide-y overflow-y-auto",children:i.map((o,a)=>{var f;return u.jsxs("div",{className:"text-ui-fg-subtle flex items-center justify-between px-6 py-3",children:[u.jsx(Dn,{size:"small",children:o.label}),u.jsx("div",{className:"flex items-center gap-x-1",children:(f=o.keys.Mac)==null?void 0:f.map((d,m)=>u.jsx("div",{className:"flex items-center gap-x-1",children:u.jsx(at,{children:d})},m))})]},a)})})]})]})]})},Ve=40,Ft=e=>{const n=e.getIsPinned(),s=document.documentElement.classList.contains("dark")?"rgb(50,50,53)":"rgb(228,228,231)";return{position:n?"sticky":"relative",width:e.getSize(),zIndex:n?1:0,borderBottom:n?`1px solid ${s}`:void 0,borderRight:n?`1px solid ${s}`:void 0,left:n==="left"?`${e.getStart("left")}px`:void 0,right:n==="right"?`${e.getAfter("right")}px`:void 0}},Vs=({data:e=[],columns:n,state:t,getSubRows:s,onEditingChange:r,disableInteractions:l,multiColumnSelection:i=!1,showColumnsDropdown:o=!0,totalRowCount:a,onFetchMore:f,isFetchingMore:d,hasNextPage:m,headerContent:h})=>{var lt,ot;const x=a!==void 0,g=c.useRef(null),{redo:p,undo:v,execute:j}=Fs(),{register:y,control:C,getValues:S,setValue:k,formState:{errors:N}}=t,[K,R]=c.useState(!0),A=!l&&K,[I,re]=c.useState(null),[T,$]=c.useState(null),[Q,ee]=c.useState(null),[z,V]=c.useState(!1),[Y,_]=c.useState(!1),[L,le]=c.useState(!1),[W,te]=c.useState({}),[oe,b]=c.useState({}),w=rn({data:e,columns:n,initialState:{columnPinning:{left:[n[0].id]}},state:{columnVisibility:W},onColumnVisibilityChange:te,getSubRows:s,getCoreRowModel:ln(),defaultColumn:{size:200,maxSize:400}}),{flatRows:M}=w.getRowModel(),D=w.getAllFlatColumns(),O=c.useMemo(()=>M.filter((E,F)=>(oe==null?void 0:oe[F])!==!1),[M,oe]),P=w.getVisibleLeafColumns(),B=x?a:O.length,q=bt({count:B,estimateSize:()=>Ve,getScrollElement:()=>g.current,measureElement:typeof window<"u"&&navigator.userAgent.indexOf("Firefox")===-1?E=>E==null?void 0:E.getBoundingClientRect().height:void 0,overscan:5,rangeExtractor:E=>{const F=new Set(Array.from({length:E.endIndex-E.startIndex+1},(G,H)=>E.startIndex+H));return I&&O[I.row]&&F.add(I.row),T&&O[T.row]&&F.add(T.row),Array.from(F).sort((G,H)=>G-H)}}),Ie=q.getVirtualItems(),ae=c.useRef({onFetchMore:f,hasNextPage:m,isFetchingMore:d,loadedRowCount:O.length});c.useEffect(()=>{ae.current={onFetchMore:f,hasNextPage:m,isFetchingMore:d,loadedRowCount:O.length}},[f,m,d,O.length]);const Be=O.length>0,We=c.useCallback(()=>{const{onFetchMore:E,hasNextPage:F,isFetchingMore:G,loadedRowCount:H}=ae.current;if(!E||!F||G)return;const ue=g.current,{scrollTop:X,clientHeight:de}=ue,Zt=H*Ve,Qt=X+de,Xt=Zt-Ve*10;Qt>=Xt&&E()},[ae,g]);c.useEffect(()=>{if(!x||!Be||!g.current)return;const F=setTimeout(()=>{const G=g.current;G&&G.addEventListener("scroll",We)},100);return()=>{clearTimeout(F);const G=g.current;G==null||G.removeEventListener("scroll",We)}},[x,Be]);const Ce=bt({count:P.length,estimateSize:E=>P[E].getSize(),getScrollElement:()=>g.current,horizontal:!0,overscan:3,rangeExtractor:E=>{const F=E.startIndex,G=E.endIndex,H=new Set(Array.from({length:G-F+1},(ue,X)=>F+X));return I&&P[I.col]&&H.add(I.col),T&&P[T.col]&&H.add(T.col),H.add(0),Array.from(H).sort((ue,X)=>ue-X)}}),ne=Ce.getVirtualItems();let ve,xe;Ce&&(ne!=null&&ne.length)&&(ve=((lt=ne[0])==null?void 0:lt.start)??0,xe=Ce.getTotalSize()-(((ot=ne[ne.length-1])==null?void 0:ot.end)??0));const Z=c.useMemo(()=>new rs(M,n,i),[M,n,i]),ce=Ms(g),se=c.useCallback(E=>{re(E),$(E)},[]),{errorCount:Tt,isHighlighted:Gt,toggleErrorHighlighting:He}=fs(Z,w,N),Vt=c.useCallback(()=>{He(oe,W,b,te)},[He,oe,W]),{columnOptions:Kt,handleToggleColumn:Ue,handleResetColumns:$t,isDisabled:Lt}=us(w,Z),Bt=c.useCallback(E=>Ue(E),[Ue]),{navigateToField:Ye,scrollToCoordinates:Oe}=Ss({matrix:Z,queryTool:ce,anchor:I,columnVirtualizer:Ce,rowVirtualizer:q,flatColumns:D,setColumnVisibility:te,setSingleRange:se,visibleColumns:P,visibleRows:O}),{createSnapshot:Ae,restoreSnapshot:Wt}=as({matrix:Z,form:t}),Ne=c.useCallback(E=>{r&&r(E),E&&Ae(I),le(E)},[I,Ae,r]),{getSelectionValues:ze,setSelectionValues:Re}=hs({matrix:Z,form:t,anchor:I}),{handleKeyDownEvent:Pe,handleSpecialFocusKeys:Ze}=js({containerRef:g,matrix:Z,queryTool:ce,anchor:I,rangeEnd:T,isEditing:L,setTrapActive:R,setRangeEnd:$,getSelectionValues:ze,getValues:S,setSelectionValues:Re,onEditingChangeHandler:Ne,restoreSnapshot:Wt,createSnapshot:Ae,setSingleRange:se,scrollToCoordinates:Oe,execute:j,undo:v,redo:p,setValue:k}),{handleMouseUpEvent:Fe}=Es({matrix:Z,anchor:I,dragEnd:Q,setDragEnd:ee,isDragging:Y,setIsDragging:_,setRangeEnd:$,setIsSelecting:V,getSelectionValues:ze,setSelectionValues:Re,execute:j}),{handleCopyEvent:Te,handlePasteEvent:Ge}=cs({matrix:Z,isEditing:L,anchor:I,rangeEnd:T,getSelectionValues:ze,setSelectionValues:Re,execute:j}),{getWrapperFocusHandler:Qe,getInputChangeHandler:Xe,getOverlayMouseDownHandler:Je,getWrapperMouseOverHandler:qe,getIsCellDragSelected:et,getIsCellSelected:tt,onDragToFillStart:Ht}=os({matrix:Z,anchor:I,rangeEnd:T,setRangeEnd:$,isDragging:Y,setIsDragging:_,isSelecting:z,setIsSelecting:V,setSingleRange:se,dragEnd:Q,setDragEnd:ee,setValue:k,execute:j,multiColumnSelection:i}),{getCellErrorMetadata:nt,getCellMetadata:st}=is({matrix:Z});c.useEffect(()=>{if(A)return window.addEventListener("keydown",Pe),window.addEventListener("mouseup",Fe),window.addEventListener("copy",Te),window.addEventListener("paste",Ge),()=>{window.removeEventListener("keydown",Pe),window.removeEventListener("mouseup",Fe),window.removeEventListener("copy",Te),window.removeEventListener("paste",Ge)}},[A,Pe,Fe,Te,Ge]),c.useEffect(()=>{const E=F=>{if(zt(F)){Ze(F);return}};return window.addEventListener("keydown",E),()=>{window.removeEventListener("keydown",E)}},[Ze]);const Ut=c.useCallback(E=>{E&&R(!1)},[]);c.useEffect(()=>{I&&(T||$(I))},[I,T]),c.useEffect(()=>{if(!I&&Z){const E=Z.getFirstNavigableCell();E&&se(E)}},[I,Z,se]);const Yt=c.useMemo(()=>({anchor:I,control:C,trapActive:A,errors:N,setTrapActive:R,setIsSelecting:V,setIsEditing:Ne,setSingleRange:se,setRangeEnd:$,getWrapperFocusHandler:Qe,getInputChangeHandler:Xe,getOverlayMouseDownHandler:Je,getWrapperMouseOverHandler:qe,register:y,getIsCellSelected:tt,getIsCellDragSelected:et,getCellMetadata:st,getCellErrorMetadata:nt,navigateToField:Ye}),[I,C,A,N,R,V,Ne,se,$,Qe,Xe,Je,qe,y,tt,et,st,nt,Ye]),rt=c.useCallback(()=>{I&&!A&&(R(!0),se(I),Oe(I,"both"),requestAnimationFrame(()=>{var E;(E=ce==null?void 0:ce.getContainer(I))==null||E.focus()}))},[I,A,se,Oe,ce]);return u.jsx(Ot.Provider,{value:Yt,children:u.jsxs("div",{className:"bg-ui-bg-subtle flex size-full flex-col",children:[u.jsx(Ks,{showColumnsDropdown:o,columnOptions:Kt,isDisabled:Lt,onToggleColumn:Bt,errorCount:Tt,onToggleErrorHighlighting:Vt,onResetColumns:$t,isHighlighted:Gt,onHeaderInteractionChange:Ut,headerContent:h}),u.jsx("div",{className:"size-full overflow-hidden",children:u.jsx("div",{ref:g,autoFocus:!0,tabIndex:0,className:"relative h-full select-none overflow-auto outline-none",onFocus:rt,onClick:rt,"data-container":!0,role:"application",children:u.jsxs("div",{role:"grid",className:"text-ui-fg-subtle grid",children:[u.jsx("div",{role:"rowgroup",className:"txt-compact-small-plus bg-ui-bg-subtle sticky top-0 z-[1] grid",children:w.getHeaderGroups().map(E=>u.jsxs("div",{role:"row",className:"flex h-10 w-full",children:[ve?u.jsx("div",{role:"presentation",style:{display:"flex",width:ve}}):null,ne.reduce((F,G,H,ue)=>{const X=E.headers[G.index],de=ue[H-1];return de&&G.index!==de.index+1&&F.push(u.jsx("div",{role:"presentation",style:{display:"flex",width:`${G.start-de.end}px`}},`padding-${de.index}-${G.index}`)),F.push(u.jsx("div",{role:"columnheader","data-column-index":G.index,style:{width:X.getSize(),...Ft(X.column)},className:"bg-ui-bg-base txt-compact-small-plus flex items-center border-b border-r px-4 py-2.5",children:X.isPlaceholder?null:wt(X.column.columnDef.header,X.getContext())},X.id)),F},[]),xe?u.jsx("div",{role:"presentation",style:{display:"flex",width:xe}}):null]},E.id))}),u.jsx("div",{role:"rowgroup",className:"relative grid",style:{height:`${q.getTotalSize()}px`},children:Ie.map(E=>{const F=O[E.index];if(!F)return u.jsx(Bs,{virtualRow:E,virtualColumns:ne,virtualPaddingLeft:ve,virtualPaddingRight:xe},`skeleton-${E.index}`);const G=M.findIndex(H=>H.id===F.id);return u.jsx(Ls,{row:F,rowIndex:G,virtualRow:E,rowVirtualizer:q,flatColumns:D,virtualColumns:ne,anchor:I,virtualPaddingLeft:ve,virtualPaddingRight:xe,onDragToFillStart:Ht,multiColumnSelection:i},F.id)})})]})})})]})})},Ks=({columnOptions:e,isDisabled:n,onToggleColumn:t,onResetColumns:s,isHighlighted:r,errorCount:l,onToggleErrorHighlighting:i,onHeaderInteractionChange:o,showColumnsDropdown:a,headerContent:f})=>{const[d,m]=c.useState(!1),[h,x]=c.useState(!1),{t:g}=we(),p=mn(),v=e.some(C=>!C.checked),j=C=>{o(C),m(C)},y=C=>{o(C),x(C)};return u.jsxs("div",{className:"bg-ui-bg-base flex items-center justify-between border-b p-4",children:[a&&u.jsxs("div",{className:"flex items-center gap-x-2",children:[u.jsxs(ye,{dir:p,open:h,onOpenChange:y,children:[u.jsx(pn,{showTooltip:n,content:g("dataGrid.columns.disabled"),children:u.jsx(ye.Trigger,{asChild:!0,disabled:n,children:u.jsxs(je,{size:"small",variant:"secondary",children:[v?u.jsx(jt,{}):u.jsx(gn,{}),g("dataGrid.columns.view")]})})}),u.jsx(ye.Content,{children:e.map((C,S)=>{const{checked:k,disabled:N,id:K,name:R}=C;return N?null:u.jsx(ye.CheckboxItem,{checked:k,onCheckedChange:t(S),onSelect:A=>A.preventDefault(),children:R},K)})})]}),v&&u.jsx(je,{size:"small",variant:"transparent",type:"button",onClick:s,className:"text-ui-fg-muted hover:text-ui-fg-subtle","data-id":"reset-columns",children:g("dataGrid.columns.resetToDefault")})]}),f,u.jsxs("div",{className:"ml-auto flex items-center gap-x-2",children:[l>0&&u.jsxs(je,{size:"small",variant:"secondary",type:"button",onClick:i,className:U({"bg-ui-button-neutral-pressed":r}),children:[u.jsx(xt,{className:"text-ui-fg-subtle"}),u.jsx("span",{children:g("dataGrid.errors.count",{count:l})})]}),u.jsx(Gs,{open:d,onOpenChange:j})]})]})},$s=({cell:e,columnIndex:n,rowIndex:t,anchor:s,onDragToFillStart:r,multiColumnSelection:l})=>{const o=Nt({row:t,col:n},s);return u.jsx("div",{role:"gridcell","aria-rowindex":t,"aria-colindex":n,style:{width:e.column.getSize(),...Ft(e.column)},"data-row-index":t,"data-column-index":n,className:U("relative flex items-stretch border-b border-r p-0 outline-none"),tabIndex:-1,children:u.jsxs("div",{className:"relative w-full",children:[wt(e.column.columnDef.cell,{...e.getContext(),columnIndex:n,rowIndex:t}),o&&u.jsx("div",{onMouseDown:r,className:U("bg-ui-fg-interactive absolute bottom-0 right-0 z-[3] size-1.5 cursor-ns-resize",{"cursor-nwse-resize":l})})]})})},Ls=({row:e,rowIndex:n,virtualRow:t,rowVirtualizer:s,virtualPaddingLeft:r,virtualPaddingRight:l,virtualColumns:i,flatColumns:o,anchor:a,onDragToFillStart:f,multiColumnSelection:d})=>{const m=e.getVisibleCells();return u.jsxs("div",{role:"row","aria-rowindex":t.index,"data-index":t.index,ref:h=>s.measureElement(h),style:{transform:`translateY(${t.start}px)`},className:"bg-ui-bg-subtle txt-compact-small absolute flex min-h-10 w-full",children:[r?u.jsx("div",{role:"presentation",style:{display:"flex",width:r}}):null,i.reduce((h,x,g,p)=>{const v=m[x.index],j=v.column,y=o.findIndex(S=>S.id===j.id),C=p[g-1];return C&&x.index!==C.index+1&&h.push(u.jsx("div",{role:"presentation",style:{display:"flex",width:`${x.start-C.end}px`}},`padding-${C.index}-${x.index}`)),h.push(u.jsx($s,{cell:v,columnIndex:y,rowIndex:n,anchor:a,onDragToFillStart:f,multiColumnSelection:d},v.id)),h},[]),l?u.jsx("div",{role:"presentation",style:{display:"flex",width:l}}):null]})},Bs=({virtualRow:e,virtualPaddingLeft:n,virtualPaddingRight:t,virtualColumns:s})=>u.jsxs("div",{role:"row","aria-rowindex":e.index,style:{transform:`translateY(${e.start}px)`},className:"bg-ui-bg-subtle txt-compact-small absolute flex h-10 w-full",children:[n?u.jsx("div",{role:"presentation",style:{display:"flex",width:n}}):null,s.map((r,l,i)=>{const o=i[l-1],a=[];return o&&r.index!==o.index+1&&a.push(u.jsx("div",{role:"presentation",style:{display:"flex",width:`${r.start-o.end}px`}},`padding-${o.index}-${r.index}`)),a.push(u.jsx("div",{role:"gridcell",style:{width:r.size},className:"relative flex items-center border-b border-r p-0 outline-none",children:u.jsx("div",{className:"flex h-full w-full items-center px-4",children:u.jsx("div",{className:"bg-ui-bg-component h-4 w-3/4 animate-pulse rounded"})})},`skeleton-cell-${r.index}`)),a}),t?u.jsx("div",{role:"presentation",style:{display:"flex",width:t}}):null]}),Ws=({context:e})=>{const{field:n,control:t,renderProps:s}=ge({context:e}),r=ie({context:e}),{container:l,input:i}=s;return u.jsx(me,{control:t,name:n,render:({field:o})=>u.jsx(be,{...l,...r,children:u.jsx(Hs,{field:o,inputProps:i})})})},Hs=({field:e,inputProps:n})=>{const{onChange:t,onBlur:s,ref:r,value:l,...i}=e,{ref:o,onBlur:a,onChange:f,...d}=n,[m,h]=c.useState(l),x=c.useRef(null);c.useEffect(()=>{h(l)},[l]);const g=pe(o,r,x);return u.jsx("input",{className:U("txt-compact-small text-ui-fg-subtle flex size-full cursor-pointer bg-transparent outline-none","focus:cursor-text","items-center justify-center"),autoComplete:"off",tabIndex:-1,value:m??"",onChange:p=>h(p.target.value),ref:g,onBlur:()=>{s(),a(),f(m,l)},...d,...i})},Us=({context:e,fieldLabel:n})=>{const{field:t,control:s,renderProps:r}=ge({context:e}),l=ie({context:e}),{container:i,input:o}=r;return u.jsx(me,{control:s,name:t,render:({field:a})=>u.jsx(Ys,{field:a,inputProps:o,fieldLabel:n,container:i,errorProps:l})})},Ys=({field:e,inputProps:n,fieldLabel:t,container:s,errorProps:r})=>{const{onChange:l,onBlur:i,ref:o,value:a,...f}=e,{ref:d,onBlur:m,onChange:h,...x}=n,{setSingleRange:g,anchor:p}=De(),{row:v,col:j}=p||{row:0,col:0},[y,C]=c.useState(a||""),[S,k]=c.useState(!1),[N,K]=c.useState(a||""),R=c.useRef(null);c.useEffect(()=>{C(a||"")},[a]),c.useEffect(()=>{S&&K(a||"")},[S,a]),c.useEffect(()=>{if(!S||!R.current)return;const z=V=>{const Y=V.target,_=Y.tagName==="TEXTAREA",L=R.current&&R.current.contains(Y);(_||L)&&["Enter","Delete","Backspace","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab"," "].includes(V.key)&&V.key!=="Escape"&&V.stopImmediatePropagation()};return window.addEventListener("keydown",z,!0),()=>{window.removeEventListener("keydown",z,!0)}},[S]);const A=pe(d,o),I=c.useCallback(z=>{var V,Y;if(z.detail===2){z.preventDefault(),z.stopPropagation(),g({row:v,col:j}),k(!0);return}(Y=(V=s.overlayProps).onMouseDown)==null||Y.call(V,z)},[s.overlayProps,g,v,j]),re={...s,overlayProps:{...s.overlayProps,onMouseDown:I}},T=()=>{h(N,a),C(N),k(!1),i(),m()},$=c.useCallback(z=>{z.key!=="Escape"&&z.stopPropagation()},[]),Q=y||"",ee=Q.length>50?`${Q.substring(0,50)}...`:Q;return u.jsxs(cn,{open:S,onOpenChange:z=>{z?k(!0):T()},children:[u.jsxs(be,{...re,...r,children:[u.jsx(un,{asChild:!0,children:u.jsx("div",{className:U("txt-compact-small text-ui-fg-subtle flex size-full cursor-pointer items-center justify-center bg-transparent outline-none","focus:cursor-text"),children:u.jsx("span",{className:"w-full truncate text-center",children:ee})})}),u.jsx("input",{className:"sr-only",autoComplete:"off",tabIndex:-1,value:y,onChange:z=>C(z.target.value),ref:A,onBlur:()=>{i(),m(),h(y,a)},...x,...f})]}),u.jsx(dn,{children:u.jsx(fn,{className:U("bg-ui-bg-base shadow-elevation-flyout flex max-h-[80vh] w-[600px] overflow-hidden p-0 outline-none"),align:"start",side:"bottom",sideOffset:-29,alignOffset:-16,collisionPadding:24,onEscapeKeyDown:T,onKeyDown:$,children:u.jsx("div",{ref:R,className:"h-full w-full",children:u.jsx(In,{value:N,onChange:z=>K(z.target.value),onKeyDown:z=>{z.stopPropagation()},className:"!bg-ui-bg-base h-full min-h-[300px] w-full resize-none border-0 p-4 !shadow-none focus-visible:!shadow-none"})})})})]})},Zs=({isLoading:e,totalRowCount:n,onFetchMore:t,isFetchingMore:s,hasNextPage:r,...l})=>{var i;return e?u.jsx(Jn,{columns:l.columns,rows:(i=l.data)!=null&&i.length&&l.data.length>0?l.data.length:10}):u.jsx(Vs,{...l,totalRowCount:n,onFetchMore:t,isFetchingMore:s,hasNextPage:r})},tr=Object.assign(Zs,{BooleanCell:Is,TextCell:Ws,MultilineCell:Ns,ExpandableTextCell:Us,NumberCell:Rs,CurrencyCell:Ke,ReadonlyCell:$e});function Qs(){const e=tn();return{column:({id:n,name:t,header:s,cell:r,disableHiding:l=!1,field:i,type:o,size:a,minSize:f,maxSize:d})=>e.display({id:n,header:s,cell:r,enableHiding:!l,size:a,minSize:f,maxSize:d,meta:{name:t,field:i,type:o}})}}var vt=({includesTax:e})=>{const{t:n}=we();return u.jsx(Le,{maxWidth:999,content:n(e?"general.includesTaxTooltip":"general.excludesTaxTooltip"),children:e?u.jsx(Dt,{className:"text-ui-fg-muted shrink-0"}):u.jsx(St,{className:"text-ui-fg-muted shrink-0"})})},nr=({currencies:e,regions:n,pricePreferences:t,isReadyOnly:s,getFieldName:r,t:l})=>{const i=Qs();return[...(e==null?void 0:e.map(o=>{const a=t==null?void 0:t.find(d=>d.attribute==="currency_code"&&d.value===o),f=l("fields.priceTemplate",{regionOrCurrency:o.toUpperCase()});return i.column({id:`currency_prices.${o}`,name:l("fields.priceTemplate",{regionOrCurrency:o.toUpperCase()}),field:d=>(s==null?void 0:s(d))?null:r(d,o),type:"number",header:()=>u.jsxs("div",{className:"flex w-full items-center justify-between gap-3",children:[u.jsx("span",{className:"truncate",title:f,children:f}),u.jsx(vt,{includesTax:a==null?void 0:a.is_tax_inclusive})]}),cell:d=>s!=null&&s(d)?u.jsx($e,{context:d}):u.jsx(Ke,{code:o,context:d})})}))??[],...(n==null?void 0:n.map(o=>{const a=t==null?void 0:t.find(d=>d.attribute==="region_id"&&d.value===o.id),f=l("fields.priceTemplate",{regionOrCurrency:o.name});return i.column({id:`region_prices.${o.id}`,name:l("fields.priceTemplate",{regionOrCurrency:o.name}),field:d=>(s==null?void 0:s(d))?null:r(d,o.id),type:"number",header:()=>u.jsxs("div",{className:"flex w-full items-center justify-between gap-3",children:[u.jsx("span",{className:"truncate",title:f,children:f}),u.jsx(vt,{includesTax:a==null?void 0:a.is_tax_inclusive})]}),cell:d=>s!=null&&s(d)?u.jsx($e,{context:d}):(e==null?void 0:e.find(h=>h===o.currency_code))?u.jsx(Ke,{code:o.currency_code,context:d}):null})}))??[]]};export{tr as D,vt as I,nr as a,Jn as b,Qs as c,$e as d,ge as e,ie as f,be as g,pe as h,er as u};
